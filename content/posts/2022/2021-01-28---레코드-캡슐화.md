---
title: ë ˆì½”ë“œ ìº¡ìŠí™”í•˜ê¸°
date: "2022-01-28"
template: "post"
draft: false
slug: "/posts/refactoring/encapsulate-record"
category: "javascript"
tags:
  - "ë ˆì½”ë“œ ìº¡ìŠí™”"
  - "ìº¡ìŠí™”"
  - "ë¦¬íŒ©í† ë§"
  - "7.1ì¥"
  - "ë¦¬íŒ©í† ë§ ë„ì„œ ì •ë¦¬"
description: ë ˆì½”ë“œ ìº¡ìŠí™”í•˜ê¸°
---

ë ˆì½”ë“œë€ ë‹¨ì–´ë¼ ìì²´ê°€ êµ‰ì¥íˆ ìƒì†Œí•˜ê²Œ ëŠê»´ì§„ë‹¤. ì»´í“¨í„° ê³µí•™ì ì¸ ë‹¨ì–´ë¡œ í‘œí˜„í•´ì„œ ë‚¯ì„¤ì§€ë§Œ, ì‚¬ì‹¤ Array, Objectë“±ì„ ë– ì˜¬ë¦¬ë©´ ì‰½ë‹¤.

> ì»´í“¨í„° ê³¼í•™ì—ì„œ **ë ˆì½”ë“œ(record, struct)ëŠ” ê¸°ë³¸ì ì¸ ìë£Œ êµ¬ì¡°ì´ë‹¤.** ë°ì´í„°ë² ì´ìŠ¤ë‚˜ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì˜ ë ˆì½”ë“œëŠ” ë³´í†µ ë¡œìš°(row)ë¼ê³  ë¶€ë¥¸ë‹¤.

JSì—ì„œëŠ” ë³´í†µ ì•„ë˜ì™€ ê°™ì€ ê²ƒ ë– ì˜¬ë¦¬ë©´ ì‰½ë‹¤.

```js
const organization = { name: "ê¹€ìš”í•œ", country: "KR" };
```

ë ˆì½”ë“œì˜ ë‹¨ì ì´ë¼ë©´ ê³„ì‚°í•´ì„œ ì–»ì„ ìˆ˜ ìˆëŠ” ê°’ê³¼, ê·¸ë ‡ì§€ ì•Šê³  ì§ì ‘ ì–»ì„ ìˆ˜ ìˆëŠ” ê°’ì„ ëª…í™•íˆ êµ¬ë¶„í•´ì„œ ì €ì¥í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤.

ê°’ì˜ ë²”ìœ„ë¥¼ í‘œí˜„í•˜ëŠ” ë ˆì½”ë“œê°€ ìˆë‹¤ê³  í•˜ì. ì‹œì‘ê³¼ ë, ê·¸ë¦¬ê³  ê¸¸ì´ë¥¼ í‘œí˜„í•˜ë ¤ê³  í•œë‹¤.

```js
{start:1, end:5}
{start:1, length:5}
{end:5, length:5}
```

ìœ„ì™€ ê°™ì´ ê°ê¸° ë‹¤ë¥¸ ì„¸ê°€ì§€ í˜•ì‹ìœ¼ë¡œ ë ˆì½”ë“œë¥¼ í‘œí˜„í•  ìˆ˜ ìˆëŠ”ë°, ì–´ì°Œë˜ì—ˆë“  ì‹œì‘ê³¼ ëì˜ ê¸¸ì´ë¥¼ ì•Œ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.

### ê°ì²´ ì‚¬ìš©

ê°ì²´ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ìœ„ ì„¸ê°€ì§€ ê°’(start, end, length)ì„ ëª¨ë‘ ë©”ì†Œë“œë¡œ ì œê³µ ê°€ëŠ¥í•˜ë‹¤.<br>
ì‚¬ìš©ìê°€ **ì‚¬ìš©í•  ë•Œ ì–´ë–¤ ê°’ì´ ì €ì¥ëœ í˜•íƒœë¡œ ê°€ì ¸ì˜¤ëŠ” ê±´ì§€, í˜¹ì€ ê³„ì‚°í•´ì„œ ê°€ì ¸ì˜¤ëŠ” ê±´ì§€ ì•Œ í•„ìš”ê°€ ì—†ë‹¤.** <br>
ë˜í•œ í•„ë“œ ì´ë¦„ì´ ë°”ë€ë‹¤ê³  í•´ë„ ê°ê°ì˜ ë©”ì†Œë“œë¡œ ì œê³µì´ ê°€ëŠ¥í•˜ë‹¤.



> <span style="font-size:1.2rem;">ğŸ‘‰ğŸ‘‰ğŸ¿ğŸ‘‰ğŸ½ **ì¦‰, ë ˆì½”ë“œë¥¼ ë‹¤ë£¨ëŠ” ì¼ì´ ë§ë‹¤ë©´ ì´ë¥¼ ìº¡ìŠí™” í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.**</span>

<br>


### ë ˆì½”ë“œ ê°’ì´ ë°”ë€” ì¼ì´ ì—†ë‹¤ë©´? (ë ˆì½”ë“œ ê°’ì´ ë¶ˆë³€ì¼ ê²½ìš°)

ë ˆì½”ë“œ ê°’ì´ ë¶ˆë³€ì´ë¼ë©´ ìœ„ì˜ ê²½ìš° ë‹¨ìˆœíˆ ì‹œì‘ê³¼ ëì˜ ê¸¸ì´ë¥¼ ëª¨ë‘ êµ¬í•´ì„œ ë ˆì½”ë“œì— ì €ì¥í•œë‹¤.

```js
const myRecord = { start: 1, end: 5, length: 5};
```

<br>

---

### ë‹¨ìˆœí•œ ë ˆì½”ë“œ ìº¡ìŠí™”í•˜ê¸°

```ts
const organization = { name: "ê¹€ìš”í•œ", country: "KR" };
```

<br>

ìœ„ì™€ ê°™ì€ ë ˆì½”ë“œê°€ ìˆë‹¤ê³  í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•  ê²ƒì´ë‹¤.

```tsx
result += `<h1>${organization.name}</h1>`;
organization.name = newName;
```

ì´ë ‡ê²Œ ì“°ëŠ” ê²½ìš°ê°€ ë§ì§€ë§Œ ì´ëŸ´ ê²½ìš° ë ˆì½”ë“œê°€ ë°”ë€” ê²½ìš° ìˆ˜ì •í•˜ê¸°ê°€ ì–´ë µë‹¤. ë˜í•œ ì‹¤ìˆ˜ë¡œ ì˜ëª» ì¡°ì‘í•  ê²½ìš° ì›ë³¸ ë ˆì½”ë“œ ê°’ì´ ìˆ˜ì •ë  ìœ„í—˜ì´ í•­ìƒ ì¡´ì¬í•œë‹¤.
<br>
<br>

### 1ë‹¨ê³„ ìš°ì„  ìƒìˆ˜ë¥¼ ìº¡ìŠí™”ì‹œí‚¨ë‹¤.

ë°ì´í„°ëŠ” ì°¸ì¡°í•˜ëŠ” ëª¨ë“  ë¶€ë¶„ì„ í•œë²ˆì— ë°”ê¿”ì•¼ ì½”ë“œê°€ ì œëŒ€ë¡œ ì‘ë™í•œë‹¤.<br>
ë”°ë¼ì„œ ë°ì´í„°ì— ì ‘ê·¼í•˜ë ¤ê³  í•  ë•Œì—ëŠ” ê·¸ ë°ì´í„°ë¡œ ì ‘ê·¼ì„ ë…ì í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“œëŠ” ì‹ìœ¼ë¡œ ìº¡ìŠí™”í•˜ëŠ” ë°©ë²•ì´ ì œì¼ ì¢‹ë‹¤.

> ë§ˆí‹´ íŒŒìš¸ëŸ¬ì˜ ê²½ìš° **ìœ íš¨ë²”ìœ„ê°€ í•¨ìˆ˜ í•˜ë‚˜ë³´ë‹¤ ë„“ì€ ê°€ë³€ ë°ì´í„°ëŠ” ëª¨ë‘ ìº¡ìŠí™”**í•´ì„œ ê·¸ í•¨ìˆ˜ë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼í•˜ê²Œ ë³€ê²½í•œë‹¤ê³  ë§í•œë‹¤.

<br>

```js
function getRawDataOfOrganization() {
  return organization;
}

result += `<h1>${getRawDataOfOrganization().name}</h1>`;
getRawDataOfOrganization().name = newName;

```


ì¼ë‹¨ ì´ë ‡ê²Œ ìº¡ìŠí™”ë¥¼ í•˜ê²Œ ë˜ë©´ ë³€ìˆ˜ëŠ” ë¬¼ë¡ ì´ê³  ì¡°ì‘í•˜ëŠ” ë°©ë²•ë„ í†µì œê°€ ê°€ëŠ¥í•˜ë‹¤.


### 2ë‹¨ê³„ Organization í´ë˜ìŠ¤ë¥¼ ë§Œë“ ë‹¤. 

```js
class Organization {
  constructor(data) {
    this._data = data;
  }
}

const organization = new Organization({ name: "ê¹€ìš”í•œ", country: "KR" });

function getRawDataOfOrganization() {
  return organization._data;
}

function getOrganization() {
  return organization;
}
```

<br>
<br>

### 3ë‹¨ê³„ Organization í´ë˜ìŠ¤ ìƒì„±ì ë‚´ì—ì„œ ê° ë°ì´í„°ë“¤ì„ ì„¤ì •í•´ì¤€ë‹¤.

```js
class Organization {
  constructor(data) {
    this._name = data.name;
    this._country = data.country;
  }
  get name() {
    return this._name;
  }

  set name(arg) {
    return (this._name = arg);
  }

  get country() {
    return this._country;
  }

  set country(arg) {
    this._country = arg;
  }
}
```

<br>

## ë³µì¡í•œ ë ˆì½”ë“œ ìº¡ìŠí™”í•˜ê¸°

í•˜ì§€ë§Œ ë³´í†µ ì‹¤ë¬´ ë ˆì½”ë“œ ì¤‘ì—ì„œ ë” ë³µì¡í•œ ê²½ìš°ê°€ ìˆë‹¤. 

```js
 "1920":{
   name:"ê¹€ìš”í•œ",
   id:"1920",
   usages:{
     "2022":{
       "1": 50,
       "2":55
     },
     "2021":{
       "1":70,
       "2":75,
     }
   }
 }
```

ì´ë ‡ê²Œ ì¤‘ì²©ëœ ë ˆì½”ë“œëŠ” ë” ê¹Œë‹¤ë¡­ë‹¤.

ì‚¬ìš©ë˜ëŠ” ê³³ ì½”ë“œë¥¼ ë³´ë©´ ì•„ë˜ì™€ ê°™ì„ ê²ƒì´ë‹¤.

```js
const abc = (customerData[customerID].usages[year][month] = amount);
```

```js
function compareUsage(customerID, laterYear, month) {
  const later = customerData[customerID].usages[laterYear][month];
  const earlier = customerData[customerID].usages[laterYear - 1][month];
  return {
    laterAmount: later,
    change: later - earlier,
  };
}
```
<br>

### ë‹¨ê³„1. ì¼ë‹¨ ë³€ìˆ˜ ìº¡ìŠí™” ë¶€í„° ì§„í–‰í•œë‹¤.

```js
function getRawDataOfCustomers() {
  return customerData;
}
function setRawDataOfCustomers(data) {
  customerData = data;
}
```
ê·¸ëŸ¼ ì´ë ‡ê²Œ ë°”ë€ë‹¤. 
```js
getRawDataOfCustomers()[customerID].usages[year][month] = amount;
function compareUsage(customerID, laterYear, month) {
  const later = getRawDataOfCustomers()[customerID].usages[laterYear][month];
  const earlier =
    getRawDataOfCustomers()[customerID].usages[laterYear - 1][month];
  return {
    laterAmount: later,
    change: later - earlier,
  };
}
```

ì–´ì§¸ ì§€ê¸ˆ ìƒíƒœëŠ” ë” ë³µì¡í•´ì§„ ëŠë‚Œì´ë‹¤. ë¹¨ë¦¬ í•˜ë‚˜ì”© ìº¡ìŠí™”ë¥¼ ì§„í–‰í•´ë³´ì.

### ë‹¨ê³„ 2: ì „ì²´ ë°ì´í„° êµ¬ì¡°ë¥¼ í‘œí˜„í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ ì •ì˜í•˜ê³ , ì´ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ìƒˆë¡œ ë§Œë“ ë‹¤.

```js
class CustomerData {
  constructor(data) {
    this._data = data;
  }
}

// ìµœìƒìœ„ì—ì„œëŠ”..
function getCustomerData() {
  return customerData;
}
function getRawDataOfCustomers() {
  return customerData._data;
}

function setRawDataOfCustomers(arg) {
  customerDataData = new CustomerData(arg);
}

```
<br>



### 3ë‹¨ê³„: ë°ì´í„° êµ¬ì¡° ì•ˆìœ¼ë¡œ ê¹Šì´ ë“¤ì–´ê°€ì„œ ì„¸í„°ë¡œ ë½‘ì•„ë‚´ëŠ” ì‘ì—…ì„ í•œë‹¤.

```js
function setUsage(customerId, year, month, amount) {
  return (getRawDataOfCustomers()[customerId].usages[year][month] = amount);
}
setUsage(customerId, year, month, amount);
```

```js
// ì‚¬ìš©í•˜ëŠ” ê³³ 
getCustomerData().setUsage(customerId, year, month, amount);
```
<br>

### 4ë‹¨ê³„: setUsage í•¨ìˆ˜ë¥¼ ê³ ê° ë°ì´í„° í´ë˜ìŠ¤ë¡œ ì˜®ê¸´ë‹¤.

```js
class CustomerData {
  constructor(data) {
    this._data = data;
  }
  setUsage(customerId, year, month, amount) {
    this._data[customerId].usages[year][month] = amount;
  }
}
```
ê°’ì„ ìˆ˜ì •í•˜ëŠ” ë¶€ë¶„ì„ ëª…í™•í•˜ê²Œ ë“œëŸ¬ë‚´ê³  í•œê³³ì— ëª¨ì•„ë‘ëŠ” ì¼ì´ ì¤‘ìš”í•˜ë‹¤.

### 5ë‹¨ê³„: ë¹ ì§„ ë¶€ë¶„ì´ ì—†ëŠ”ì§€ëŠ” ë°ì´í„°ë¥¼ ê¹Šì€ë³µì‚¬í•´ì„œ ë°˜í™˜í•˜ì—¬ ë³¸ë‹¤.

```js
function getCustomerData() {
  return customerData;
}
function getRawDataOfCustomers() {
  return customerData._data;
}

function setRawDataOfCustomers(arg) {
  customerDataData = new CustomerData(arg);
}
```



```js
class CustomerData {
  constructor(data) {
    this._data = data;
  }
  setUsage(customerId, year, month, amount) {
    this._data[customerId].usages[year][month] = amount;
  }
  get rawData() {
    return _.cloneDeep(this.data);  // ë¹ ì§„ ë¶€ë¶„ì´ ì—†ëŠ”ì§€ ê¹Šì€ ë³µì‚¬ë¡œ í™•ì¸
  }
}

```
<br>

### ì½ëŠ” ë°©ë²•

ì½ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ê°€ì§€ê°€ ìˆì§€ë§Œ, ìš°ì„  ì½ëŠ” ì½”ë“œë¥¼ ëª¨ë‘ ë…ë¦½ í•¨ìˆ˜ë¡œ ì¶”ì¶œí•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤. 

```js

class CustomerData {
  constructor(data) {
    this._data = data;
  }
  setUsage(customerId, year, month, amount) {
    this._data[customerId].usages[year][month] = amount;
  }
  get rawData() {
    return _.cloneDeep(this.data);
  }
  usage(customerId, year, month) {
    return this._data[customerId].usages[year][month];
  }
}


function compareUsage(customerID, laterYear, month) {
  const later = getCustomerData().usage(customerID, laterYear, month);
  const earlier = getCustomerData().usage(customerID, laterYear-1, month);
  return {
    laterAmount: later,
    change: later - earlier,
  };
}
```
<br>


ë˜ëŠ” ì›ë³¸ ë°ì´í„°ë¥¼ ë³µì‚¬í•´ì„œ ì¤˜ë„ ëœë‹¤. í•˜ì§€ë§Œ cloneDeepì„ ë„ëŠë¼ ì¡°ê¸ˆ ëŠë ¤ì§ˆ ìˆ˜ ìˆë‹¤.

```js
function compareUsage(customerID, laterYear, month) {
  const later = getCustomerData().rawData[customerID].usage(customerID, laterYear, month);
  const earlier = getCustomerData().rawData[customerID].usage(customerID, laterYear-1, month);
  return {
    laterAmount: later,
    change: later - earlier,
  };
}
```